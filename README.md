# Lispy

Компактный интерпретатор Scheme (Lisp), написанный на Python.

## Возможности

- **Ядро Scheme**: Поддержка лямбда-исчисления, лексических областей видимости (closures), `define`, `set!`, `if`, `quote`.
- **Типы данных**: Числа (int, float, complex), строки, символы, списки, булевы значения (`#t`, `#f`).
- **Синтаксический сахар**: Комментарии (`;`), цитирование (`'`), квазицитирование (`` ` ``, `,`, `,@`).
- **Макросы**: Гигиенические макросы через `define-macro`. Встроенные макросы: `let`, `and`.
- **Оптимизация**: Оптимизация хвостовой рекурсии (TCO) позволяет выполнять бесконечные циклы без переполнения стека.
- **Продолжения**: Поддержка `call/cc` (call-with-current-continuation).
- **Модульность**: Код разделен на логические модули для удобства поддержки и расширения.

## Структура проекта

```
lispy/
    __init__.py    # Инициализация пакета
    types.py       # Типы данных (Symbol, Exp, Atom)
    parser.py      # Токенизатор и парсер
    env.py         # Окружение (Environment)
    evaluator.py   # Вычислитель (eval)
    macros.py      # Система макросов
    primitives.py  # Стандартная библиотека функций
    repl.py        # Read-Eval-Print Loop
tests/
    test_integration.py # Интеграционные тесты
    test_parser.py      # Юнит-тесты парсера
    test_env.py         # Юнит-тесты окружения
```

## Установка и запуск

### Требования
- Python 3.6+

### Запуск REPL
Чтобы запустить интерактивную оболочку:

```bash
python3 -m lispy.repl
```

Пример сессии:
```scheme
lispy> (define r 10)
None
lispy> (* 3.141592653 (* r r))
314.1592653
lispy> (define (fact n) (if (<= n 1) 1 (* n (fact (- n 1)))))
None
lispy> (fact 10)
3628800
```

### Запуск файла
```bash
python3 -m lispy.repl my_script.scm
```

## Тестирование

Проект использует `pytest` для тестирования.

```bash
# Установка зависимостей (если необходимо)
pip install pytest

# Запуск всех тестов
pytest
```

## Реализованные фичи (Checklist)

- [x] Базовый синтаксис и семантика Scheme
- [x] REPL
- [x] Арифметика и математические функции
- [x] Строки и комментарии
- [x] Макросы (`define-macro`)
- [x] `let`, `and`, `or` (через макросы)
- [x] Хвостовая рекурсия (TCO)
- [x] `call/cc`
- [x] Модульная архитектура
- [x] Покрытие тестами
